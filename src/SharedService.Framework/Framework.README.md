# INorthernFox.SharedService.Framework

Ð‘Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ° **Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ñ… Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ð¹ Ð´Ð»Ñ ASP.NET Core**, Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ð²Ð°ÑŽÑ‰Ð°Ñ ÐµÐ´Ð¸Ð½Ñ‹Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ Ðº Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ð¾Ð², Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ Ð¾ÑˆÐ¸Ð±Ð¾Ðº, Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐµ Swagger/OpenAPI Ð¸ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸ HTTP-ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð².
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ ÐºÐ°Ðº Ð¾Ð±Ñ‰Ð¸Ð¹ ÑÐ»Ð¾Ð¹ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð´Ð»Ñ Ð²ÑÐµÑ… Ð¼Ð¸ÐºÑ€Ð¾ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð² ÑÐºÐ¾ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ *SharedService*.

> **Ð¦ÐµÐ»ÐµÐ²Ð°Ñ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð°:** .NET 9.0

---

## ðŸ“¦ ÐœÐµÑ‚Ð°Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð°ÐºÐµÑ‚Ð°

| Ð¡Ð²Ð¾Ð¹ÑÑ‚Ð²Ð¾                       | Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ                                                                              |
| ------------------------------ | ------------------------------------------------------------------------------------- |
| **PackageId**                  | `INorthernFox.SharedService.Framework`                                                |
| **TFM**                        | `net9.0`                                                                              |
| **License**                    | MIT (`PackageLicenseExpression`)                                                      |
| **RepositoryUrl / ProjectUrl** | [GitHub â†’ INNorthernFox/SharedService](https://github.com/INNorthernFox/SharedService) |
| **SourceLink**                 | `Microsoft.SourceLink.GitHub` Ð²ÐºÐ»ÑŽÑ‡Ñ‘Ð½                                                 |
| **XML-Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ**           | Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ (`GenerateDocumentationFile=true`)                                       |
| **ÐÐ²Ñ‚Ð¾ÑÐ±Ð¾Ñ€ÐºÐ° Ð¿Ð°ÐºÐµÑ‚Ð°**          | Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð° (`GeneratePackageOnBuild=true`)                                              |

---

## ðŸ“š Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸

* **Microsoft.AspNetCore.OpenApi** â€” 9.0.1
* **Microsoft.EntityFrameworkCore.Design** â€” 9.0.8
* **Swashbuckle.AspNetCore.SwaggerUI** â€” 9.0.3
* **Microsoft.Extensions.Hosting** â€” 9.0.9
* **StyleCop.Analyzers** â€” 1.1.118
* **Serilog.AspNetCore** â€” 9.0.0
* **Microsoft.SourceLink.GitHub** *(PrivateAssets = All)* â€” Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ° Ð¿Ð¾ Ð¸ÑÑ…Ð¾Ð´Ð½Ð¸ÐºÐ°Ð¼ GitHub.

---

## âš™ï¸ Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

* **Endpoint Results:**
  Ð£Ð½Ð¸Ñ„Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð² API (`EndpointResult`, `ErrorsResult`, `SuccessResult`) Ð´Ð»Ñ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð¾Ð² Ð¸ Minimal API.

* **Middleware:**
  ÐžÐ±Ñ‰Ð¸Ðµ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚Ð¾Ñ‡Ð½Ñ‹Ðµ ÑÐ»Ð¾Ð¸ Ð´Ð»Ñ ASP.NET Core â€” `ExceptionMiddleware` Ð¸ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ `ExceptionMiddlewareExtension` Ð´Ð»Ñ Ð³Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð¸ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.

* **Dependency Injection:**
  Ð•Ð´Ð¸Ð½Ð°Ñ Ñ‚Ð¾Ñ‡ÐºÐ° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ñ… ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð² Ñ‡ÐµÑ€ÐµÐ· `DependencyInjection`.

* **Ð Ð°ÑÑˆÐ¸Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ:**
  ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð¾Ð², Swagger, HTTP-ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð¾Ð² Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð½Ñ‹Ñ… ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð².

---

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

```
src/SharedService.Framework/
â”‚
â”œâ”€â”€ EndpointResults/
â”‚   â”œâ”€â”€ EndpointResult.cs
â”‚   â”œâ”€â”€ ErrorsResult.cs
â”‚   â””â”€â”€ SuccessResult.cs
â”‚
â”œâ”€â”€ Middlewares/
â”‚   â”œâ”€â”€ ExceptionMiddleware.cs
â”‚   â””â”€â”€ ExceptionMiddlewareExtension.cs
â”‚
â””â”€â”€ DependencyInjection.cs
```

---
## AddOpenApiDependencies Ð² DependencyInjection
```
    public static WebApplicationBuilder AddOpenApiDependencies(this WebApplicationBuilder builder)
    {
        builder.Services.AddOpenApi(options =>
        {
            options.AddDocumentTransformer((doc, ctx, ct) =>
            {
                doc.Servers = [new OpenApiServer { Url = "/" }];
                return Task.CompletedTask;
            });

            options.AddSchemaTransformer((schema, context, _) =>
            {
                if (context.JsonTypeInfo.Type == typeof(Envelope<Errors>))
                {
                    if (schema.Properties.TryGetValue("errors", out var errorsProp))
                    {
                        errorsProp.Items.Reference = new OpenApiReference { Type = ReferenceType.Schema, Id = "Error", };
                    }
                }

                return Task.CompletedTask;
            });
        });

        return builder;
    }
```